{% extends "base.html" %}
{% load static %}

{% block title %}Home{% endblock %}

{% block content %}
    <h1>Todo App</h1>

    {% if user.is_authenticated %}
        <h2>Add New Task</h2>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">Add Task</button>
        </form>

        <h2>Your Tasks</h2>
        {% if tasks %}
            {% for task in tasks %}
                <div class="task">
                    <h3>{{ task.title }}</h3>
                    <p>{{ task.description }}</p>
                    <p>Status: <span class="status {{ task.status }}">{{ task.status }}</span></p>
                    {% if task.due_date %}
                        <p>Due: {{ task.due_date }}</p>
                    {% endif %}
                    <p>Created: {{ task.created_at }}</p>
                    <div class="task-actions">
                        <a href="{% url 'edit_task' task.id %}" class="edit-btn">Edit</a>
                        <form method="post" action="{% url 'delete_task' task.id %}">
                            {% csrf_token %}
                            <button type="submit" class="delete-btn">Delete</button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p>No tasks yet. Add some!</p>
        {% endif %}
    {% else %}
        <p>Welcome to the Todo App. Please <a href="{% url 'login' %}">login</a> or <a href="{% url 'register' %}">register</a> to manage your tasks.</p>
    {% endif %}
{% endblock %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/tasks.css' %}">
{% endblock %}